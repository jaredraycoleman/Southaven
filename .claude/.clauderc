# D&D Campaign Vault - Claude Instructions

## Essential First Steps

Before starting any task in this vault, **READ** the documentation in `DM Notes/Claude Notes/`:

- **`Vault Guide.md`** - Complete vault structure and organization
- Template instruction files for NPCs, Places, Items, Organizations, Creatures, and Session Recaps

## Project Context

This is an Obsidian vault for "The Heroes of Southaven" D&D campaign. All formatting, structure, and content guidelines are documented in `DM Notes/Claude Notes/`. Always consult those files before creating or modifying content to ensure consistency.

## Key Requirements

- Follow template instructions strictly for all content types
- Use `public: true/false` frontmatter property appropriately
- Use `%% %%` comment blocks for DM-only secrets within pages
- Create wikilinks using `[[Page Name]]` syntax
- Reference session numbers when documenting events

## Python Scripts in `.workshop/`

The `.workshop/` directory contains Python automation scripts for managing campaign content. These scripts require the `southaven` conda environment.

### Available Scripts

1. **`maker.py`** - Image generation utilities for NPCs, places, and creatures
   - Uses OpenAI's image generation API
   - Various image generators for different content types

2. **`recap.py`** - Session recap automation
   - Structured session recap generation
   - Validates frontmatter (date, date_world_start, date_world_end, summary)
   - Helps maintain consistent session documentation

3. **`character_ager.py`** - Character portrait aging tool
   - Ages character portraits to different ages (default: 11, 13, 15, 17, 20)
   - Uses OpenAI's image edit API
   - Preserves style, pose, and clothing while changing age
   - Supports "glow up/down" effects for beauty adjustments

4. **`foundry_merchant.py`** - FoundryVTT merchant actor generator
   - Creates FoundryVTT-compatible JSON actor files for merchants/NPCs
   - Includes item-piles integration for merchant functionality
   - Auto-detects NPC images from vault media files
   - Generates actors ready to import into FoundryVTT
   - Images assumed to be in FoundryVTT's `img/` directory

5. **`helpers.py`** - Shared utilities
   - Loads vault using obsidiantools
   - Provides OpenAI client configuration
   - Maps media file paths for easy access

### Usage Notes

- **ALWAYS activate the `southaven` conda environment** before running these scripts
- Scripts use environment variables from `.env` (OpenAI API key, vault path)
- The vault path is automatically detected as the parent directory of `.workshop/`
- Media files (images) are indexed in `media_paths` dictionary by filename

### Example Commands

```bash
# Activate environment first
conda activate southaven

# Age a character portrait
python .workshop/character_ager.py path/to/character.png --ages 15 20 25

# Generate FoundryVTT merchant actor
python .workshop/foundry_merchant.py "Rusty Ironbelly" \
  --shop-description "<p>Rusty's Tavern - The most popular gathering place in Southaven</p>" \
  --gold 500

# Run image generation (requires specific implementation)
python .workshop/maker.py [args]

# Generate session recap (requires specific implementation)
python .workshop/recap.py [args]
```